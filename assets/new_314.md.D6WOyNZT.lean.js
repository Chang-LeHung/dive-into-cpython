import{_ as i,c as a,a2 as n,o as h}from"./chunks/framework.BEX9PuV7.js";const g=JSON.parse('{"title":"Python 3.14 新特性","description":"","frontmatter":{},"headers":[],"relativePath":"new/314.md","filePath":"new/314.md","lastUpdated":1761064794000}'),t={name:"new/314.md"};function l(k,s,p,e,r,d){return h(),a("div",null,s[0]||(s[0]=[n(`<h1 id="python-3-14-新特性" tabindex="-1">Python 3.14 新特性 <a class="header-anchor" href="#python-3-14-新特性" aria-label="Permalink to &quot;Python 3.14 新特性&quot;">​</a></h1><p>10 月 7 日 Python 3.14 正式发布，该版本又是一个有着巨大提升的版本，可以说是继 Python 3.12 和 Python 3.13 之后的又一个史诗级版本，话不多说，此次更新最主要内容如下：</p><ul><li>Python 开始彻底多线程特性，移除了 GIL 的限制，在一个 Python 进程中可以启动多个 Interpreter，Interpreter 之间的线程没有 GIL，真正实现了多线程并发执行。Python 标准库中提供了明确的支持。</li><li>增加了一个新的 interpreter ，主要使用 clang-19 提供 tail-call 的能力，能够提升整个解释器的执行效率。</li><li>新增一个外部调试接口，可以直接通过进程号对 Python 程序进行调试。</li><li>延迟解析类型注解。</li><li>Asyncio 支持通过进程号的方式了解 asyncio 的运行情况，展示 asyncio 中的任务依赖树，提供了类似 pstree 的功能。</li></ul><h2 id="单进程多解释器" tabindex="-1">单进程多解释器 <a class="header-anchor" href="#单进程多解释器" aria-label="Permalink to &quot;单进程多解释器&quot;">​</a></h2><h2 id="tail-call-优化解释器" tabindex="-1">Tail-Call 优化解释器 <a class="header-anchor" href="#tail-call-优化解释器" aria-label="Permalink to &quot;Tail-Call 优化解释器&quot;">​</a></h2><p>该解释器主要是使用 clang-19 提供的一种编译调用规约（Calling Convention）来进行解释器本身的优化。所谓调用规约就是在汇编语言层面确定调用者和被调用者之间的参数是如何的传递的一种约定。</p><h3 id="调用规约" tabindex="-1">调用规约 <a class="header-anchor" href="#调用规约" aria-label="Permalink to &quot;调用规约&quot;">​</a></h3><p>以 System V AMD64 ABI 调用规约（主要使用在 Linux 、FreeBSD 等操作系统）为例子，下表表示各个通用寄存器的保存和恢复约定。</p><table tabindex="0"><thead><tr><th>寄存器类型</th><th>寄存器名称</th><th>说明</th></tr></thead><tbody><tr><td><strong>Caller Saved</strong></td><td>%rax</td><td>返回值寄存器，调用者负责保存</td></tr><tr><td></td><td>%rcx</td><td>第 4 个整数参数，调用者负责保存</td></tr><tr><td></td><td>%rdx</td><td>第 3 个整数参数，调用者负责保存</td></tr><tr><td></td><td>%rsi</td><td>第 2 个整数参数，调用者负责保存</td></tr><tr><td></td><td>%rdi</td><td>第 1 个整数参数，调用者负责保存</td></tr><tr><td></td><td>%r8</td><td>第 5 个整数参数，调用者负责保存</td></tr><tr><td></td><td>%r9</td><td>第 6 个整数参数，调用者负责保存</td></tr><tr><td></td><td>%r10</td><td>临时寄存器，调用者负责保存</td></tr><tr><td></td><td>%r11</td><td>临时寄存器，调用者负责保存</td></tr><tr><td><strong>Callee Saved</strong></td><td>%rbx</td><td>被调用者必须保存和恢复</td></tr><tr><td></td><td>%rbp</td><td>栈帧指针，被调用者必须保存和恢复</td></tr><tr><td></td><td>%r12</td><td>被调用者必须保存和恢复</td></tr><tr><td></td><td>%r13</td><td>被调用者必须保存和恢复</td></tr><tr><td></td><td>%r14</td><td>被调用者必须保存和恢复</td></tr><tr><td></td><td>%r15</td><td>被调用者必须保存和恢复</td></tr><tr><td><strong>特殊</strong></td><td>%rsp</td><td>栈指针，由被调用者维护</td></tr></tbody></table><p>在函数调用过程中，Caller Saved 寄存器的值可能被被调用函数修改，因此调用者在调用前需要保存这些寄存器的值。而 Callee Saved 寄存器必须由被调用函数负责保存和恢复，保证调用前后值不变，比如一个被调用的函数在编译的时候如果需要使用寄存器 %r12，那么他就需要在函数返回之间将这个寄存器恢复成函数刚调用时的值。</p><h3 id="callee-saved-寄存器示例" tabindex="-1">Callee Saved 寄存器示例 <a class="header-anchor" href="#callee-saved-寄存器示例" aria-label="Permalink to &quot;Callee Saved 寄存器示例&quot;">​</a></h3><p>以下是一个简单的 C 语言例子 <code>demo.c</code>，展示被调用函数必须保存和恢复 Callee Saved 寄存器：</p><div class="language-c vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> callee_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 42</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> result </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> callee_function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;x = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, result = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x, result);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> demo.c</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>上面的例子编译之后得到的汇编结果如下</p><div class="language-asm vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">asm</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0000000000000000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &lt;callee_function&gt;:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   f3 0f 1e fa             </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">endbr64</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">55</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">48</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 89</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> e5                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rsp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">53</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbx</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   9</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">89</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f4                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">edi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0xc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   c:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   89</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 75</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f0                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">esi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   f:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   8b </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f4                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0xc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">edx</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   8b </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f0                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  15</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d0                   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">edx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  17</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 58</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 64</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                lea</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    0x64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ebx</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  1a:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   8b </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f0                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0x10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  1d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> c0                   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  1f:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   8d</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 14</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 03</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                lea</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">edx</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   8b </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">45</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f4                </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0xc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   c1 e0 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                shl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $0x2,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  28</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d0                   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">edx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  2a:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   8d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1c </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                lea</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    (%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rax</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ebx</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2d</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">89</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> d8                   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">mov</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ebx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,%</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eax</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">  2f:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   5b                      </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">pop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbx</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  30</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                      pop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    %</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">rbp</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  31</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:   c3                      retq</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>在上面的汇编程序中使用到了 <code>rbx</code> 和 <code>ebx</code> 这两个寄存器，而这个寄存器是一个 Callee Saved 寄存器（被调用者保存的寄存器），因此在函数开始时会将 <code>rbx</code> 的值保存到栈中（<code>push %rbx</code>），在函数返回之前再将其恢复（<code>pop %rbx</code>），这就是调用规约的基本的工作原理。</p><p>如果在函数 <code>callee_function</code> 中没有保存和恢复 <code>rbx</code> 寄存器，而在调用它的函数中使用到了该寄存器，那么程序的行为将是未定义的，可能会导致程序崩溃或者结果错误，因为编译器在按照调用规约编译的时候默认 <code>rbx</code> 寄存器的值是不会被 Callee 修改的。</p><h2 id="外部调试接口" tabindex="-1">外部调试接口 <a class="header-anchor" href="#外部调试接口" aria-label="Permalink to &quot;外部调试接口&quot;">​</a></h2>`,19)]))}const y=i(t,[["render",l]]);export{g as __pageData,y as default};
